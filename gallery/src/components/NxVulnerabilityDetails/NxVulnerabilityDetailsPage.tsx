/*
 * Copyright (c) 2019-present Sonatype, Inc.
 * This program and the accompanying materials are made available under
 * the terms of the Eclipse Public License 2.0 which accompanies this
 * distribution and is available at https://www.eclipse.org/legal/epl-2.0/.
 */
import React from 'react';
import { NxTable, NxP, NxCode, NxTextLink, NxWarningAlert } from '@sonatype/react-shared-components';

import { GalleryDescriptionTile, GalleryExampleTile } from '../../gallery-components/GalleryTiles';

import NxVulnerabilityDetailsExample from './NxVulnerabilityDetailsExample';
import NxVulnerabilityDetailsThirdPartyScanExample from './NxVulnerabilityDetailsThirdPartyScanExample';

const exampleSourceCode = require('./NxVulnerabilityDetailsExample?raw');
const vulnerabilityDetailsJson = require('../../assets/vulnerabilities/vulnerabilityDetailsJson.json');
const exampleSourceForThirdPartyScans = require('./NxVulnerabilityDetailsThirdPartyScanExample?raw');
const thirdPartyScanVulnerabilityJson =
  require('../../assets/vulnerabilities/thirdPartyScanVulnerabilityDetails.json');

const NxVulnerabilityDetailsPage = () => {
  const serializedVulnDetailsJson = {
        content: JSON.stringify(vulnerabilityDetailsJson, null, 2),
        language: 'json'
      },
      serializedThirdPartyVulnJson = {
        content: JSON.stringify(thirdPartyScanVulnerabilityJson, null, 2),
        language: 'json'
      };

  return (
    <>
      <GalleryDescriptionTile>
        <NxWarningAlert>
          <NxCode>NxVulnerabilityDetails</NxCode> has been deprecated and will be removed in the future.
        </NxWarningAlert>
        <NxP>Renders vulnerability details from vulnerabilityDetails JSON</NxP>
        <NxP>Props:</NxP>
        <NxTable>
          <NxTable.Head>
            <NxTable.Row>
              <NxTable.Cell>Prop</NxTable.Cell>
              <NxTable.Cell>Type</NxTable.Cell>
              <NxTable.Cell>Required</NxTable.Cell>
              <NxTable.Cell>Details</NxTable.Cell>
            </NxTable.Row>
          </NxTable.Head>
          <NxTable.Body>
            <NxTable.Row>
              <NxTable.Cell>vulnerabilityDetails</NxTable.Cell>
              <NxTable.Cell>Object</NxTable.Cell>
              <NxTable.Cell>Yes</NxTable.Cell>
              <NxTable.Cell>
                see <NxCode>VulnerabilityDetails</NxCode> interface
                and <NxCode>vulnerabilityDetailsJson</NxCode> example below
              </NxTable.Cell>
            </NxTable.Row>
          </NxTable.Body>
        </NxTable>
        <NxP>
          VulnerabilityDetails PropType can be imported separately
          as <NxCode>vulnerabilityDetailsPropType</NxCode>.
        </NxP>
        <NxP>
          Note that markdown fields in <NxCode>vulnerabilityDetails</NxCode> JSON are expected to use{' '}
          <NxTextLink external href="https://spec.commonmark.org/">CommonMark</NxTextLink> flavored markdown.
          Also, in addition to CommonMark spec, a "soft break" is supported: a new line within a paragraph will be
          converted to <NxCode>&lt;br&gt;</NxCode> tag.
        </NxP>
      </GalleryDescriptionTile>
      <GalleryExampleTile title="General Example"
                          codeExamples={[exampleSourceCode, serializedVulnDetailsJson]}
                          liveExample={NxVulnerabilityDetailsExample}>
        This example shows the display of a typical Sonatype vulnerability with full
        details provided. In addition to the calling code, the JSON data being rendered
        is displayed in a snippet below.
      </GalleryExampleTile>
      <GalleryExampleTile title="Representative example of vulnerability data from third party scans"
                          codeExamples={[exampleSourceForThirdPartyScans, serializedThirdPartyVulnJson]}
                          liveExample={NxVulnerabilityDetailsThirdPartyScanExample}>
        This example shows the display of a typical &quot;third party&quot;
        vulnerability which contains fewer of the optional fields than the general example
        above.
      </GalleryExampleTile>
    </>
  );
};

export default NxVulnerabilityDetailsPage;
