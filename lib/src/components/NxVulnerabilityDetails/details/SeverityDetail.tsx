/*
 * Copyright (c) 2019-present Sonatype, Inc.
 * This program and the accompanying materials are made available under
 * the terms of the Eclipse Public License 2.0 which accompanies this
 * distribution and is available at https://www.eclipse.org/legal/epl-2.0/.
 */
/* eslint react/prop-types: 0 */
import React, {FunctionComponent, ReactNode} from 'react';
import {map} from 'ramda';
import {SeverityScore} from '../types';
import RenderDetail from './RenderDetail';
import SeverityScoreDisplay from './SeverityScoreDisplay';
import SubDescriptionList from './SubDescriptionList';

export interface Props {
  mainSeverity?: SeverityScore | null;
  severityScores?: SeverityScore[] | null;
}

function renderScore(severityScore: SeverityScore): ReactNode {
  return <SeverityScoreDisplay key={severityScore.source} severityScore={severityScore}/>;
}

const SeverityDetail: FunctionComponent<Props> = function SeverityDetail({mainSeverity, severityScores}) {
  const compoundedSeverities = mainSeverity
    ? [mainSeverity, ...(severityScores || [])]
    : [...(severityScores || [])];

  return compoundedSeverities && compoundedSeverities.length ? (
    <RenderDetail title="Severity">
      <SubDescriptionList>
        {map(renderScore, compoundedSeverities)}
      </SubDescriptionList>
    </RenderDetail>
  ) : null;
};

export default SeverityDetail;
