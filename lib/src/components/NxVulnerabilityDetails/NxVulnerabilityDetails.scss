/*
 * Copyright (c) 2019-present Sonatype, Inc.
 * This program and the accompanying materials are made available under
 * the terms of the Eclipse Public License 2.0 which accompanies this
 * distribution and is available at https://www.eclipse.org/legal/epl-2.0/.
 */
@use '../../scss-shared/nx-container-helpers';
@use '../../scss-shared/nx-text-helpers';

$-inline-margin: var(--nx-spacing-base);

.nx-vulnerability-details {
  @include nx-container-helpers.container-vertical;

  .nx-grid-col {
    flex: 0 1 auto;

    &:first-child {
      // don't truncate left-side content
      min-width: min-content;
    }
  }

  .nx-read-only__data, .nx-read-only__label {
    max-width: none;
  }
}

.nx-vulnerability-details__sub-description-list {
  @include nx-container-helpers.container-vertical;

  margin: 0;
}

.nx-vulnerability-details__sub-description-container {
  @include nx-text-helpers.truncate-ellipsis;
  margin-bottom: var(--nx-spacing-2x);
}

.nx-vulnerability-details__sub-description-term {
  display: inline;
  max-width: var(--nx-width-text-wrapping);
}

.nx-vulnerability-details__sub-description-desc {
  display: inline;
  margin-left: var(--nx-spacing-2x);
  max-width: var(--nx-width-text-wrapping);

  + .nx-vulnerability-details__sub-description-desc {
    margin: 0;

    &::before {
      content: ', ';
    }
  }
}

.nx-vulnerability-details__root-cause-path + .nx-vulnerability-details__root-cause-path {
  &::before {
    @include nx-text-helpers.bold;

    content: '<=';
    margin: 0 $-inline-margin 0 $-inline-margin;
  }
}

.nx-vulnerability-details__root-cause-version-range {
  &::before {
    content: ':';
    margin: 0 $-inline-margin 0 $-inline-margin;
  }
}

.nx-vulnerability-details__warning {
  @include nx-container-helpers.container-horizontal;
  color: var(--nx-swatch-red-45);

  strong {
    @include nx-text-helpers.semi-bold;
  }
}

.nx-vulnerability-details__html-detail {
  display: contents;

  p {
    @extend %nx-p;
  }

  code {
    @extend %nx-code;
  }

  pre {
    @extend %nx-pre;
  }

  blockquote {
    @extend %nx-blockquote;
  }
}
