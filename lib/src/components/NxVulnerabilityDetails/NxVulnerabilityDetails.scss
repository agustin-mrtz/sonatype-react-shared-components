/*
 * Copyright (c) 2019-present Sonatype, Inc.
 * This program and the accompanying materials are made available under
 * the terms of the Eclipse Public License 2.0 which accompanies this
 * distribution and is available at https://www.eclipse.org/legal/epl-2.0/.
 */
@use '../../scss-shared/nx-container-helpers';
@use '../../scss-shared/nx-text-helpers';

.nx-vulnerability-details {
  @include nx-container-helpers.container-vertical;
  $inline-margin: 4px;

  .nx-grid-col {
    @include nx-container-helpers.container-vertical;
    overflow-x: hidden;
  }

  .nx-grid-col--vuln-details {
    padding-left: 48px;
  }

  .nx-text-link {
    @include nx-container-helpers.container-horizontal;
  }

  p {
    margin-bottom: var(--nx-spacing-6x);
    max-width: var(--nx-width-text-wrapping);
  }

  .nx-vulnerability-details__sub-description-list {
    @include nx-container-helpers.container-vertical;

    margin: 0;

    .nx-vulnerability-details__sub-description-term {
      display: inline;
      max-width: var(--nx-width-text-wrapping);
    }

    .nx-vulnerability-details__sub-description-desc {
      display: inline;
      margin-left: var(--nx-spacing-2x);
      max-width: var(--nx-width-text-wrapping);
    }

    .nx-vulnerability-details__sub-description-desc + .nx-vulnerability-details__sub-description-desc {
      margin: 0;
      &::before {
        content: ', ';
      }
    }

    .nx-vulnerability-details__sub-description-container {
      margin-bottom: var(--nx-spacing-2x);
    }
  }

  .nx-vulnerability-details__pane {
    @include nx-container-helpers.container-vertical;
    margin: 0 auto;
    max-width: 825px;
  }

  .nx-vulnerability-details__root-cause-path + .nx-vulnerability-details__root-cause-path {
    &::before {
      @include nx-text-helpers.bold;

      content: '<=';
      margin: 0 $inline-margin 0 $inline-margin;
    }
  }

  .nx-vulnerability-details__root-cause-version-range {
    &::before {
      content: ':';
      margin: 0 $inline-margin 0 $inline-margin;
    }
  }

  .nx-vulnerability-details__section {
    @include nx-container-helpers.container-vertical;
    margin-bottom: var(--nx-spacing-8x);

    &:first-child h3 {
      margin-top: 0;
    }
  }

  .nx-vulnerability-details__warning {
    @include nx-container-helpers.container-horizontal;
    color: var(--nx-swatch-red-45);

    strong {
      @include nx-text-helpers.semi-bold;
    }
  }

  .nx-vulnerability-details__html-detail {
    @include nx-container-helpers.container-vertical;

    margin-bottom: var(--nx-spacing-4x);

    code {
      @extend %nx-code;
    }

    pre {
      @extend %nx-pre;
    }

    blockquote {
      @extend %nx-blockquote;
    }
  }
}

.nx-vulnerability-details__section-content {
  @include nx-container-helpers.container-vertical;
}
